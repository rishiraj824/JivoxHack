{"version":3,"sources":["angular-clock.min.js"],"names":["clock","$interval","$filter","restrict","scope","gmtOffset","digitalFormat","showDigital","showAnalog","startTime","theme","template","link","element","attrs","stopTime","o","undefined","showGmtInfo","parseInt","themeClass","gmtInfo","date","getDate","digital","analog","majors","Array","minors","tick","isNaN","timeText","$watch","value","getGMTbase100","getGMTText","old","on","cancel","offset","parseFloat","f","Math","floor","ceil","s","round","lpad","rpad","substring","num","now","Date","utc","getTime","getTimezoneOffset","offsetNow","hrs","getHours","mins","getMinutes","secs","getSeconds","d","format","timezone","angular","module","directive"],"mappings":"CAAA,WACE,YAgBA,SAASA,GAAMC,EAAWC,GACxB,OACEC,SAAU,KACVC,OACEC,UAAW,aACXC,cAAe,iBACfC,YAAa,eACbC,WAAY,cACZC,UAAW,aACXC,MAAO,UAETC,SAAU,4gCACVC,KAAM,SAASR,EAAOS,EAASC,GAC7B,GACEC,GACEC,KACAX,EAAYD,EAAMC,UAClBC,EAAgBF,EAAME,cAAgBF,EAAME,cAAgB,UAChEU,GAAET,YAAmC,MAArBH,EAAMG,YAAsBH,EAAMG,YAAoCU,SAAtBH,EAAMP,aAA4B,GAAO,EACzGS,EAAER,WAAiC,MAApBJ,EAAMI,WAAqBJ,EAAMI,WAAkCS,SAArBH,EAAMN,YAA2B,GAAO,EACrGQ,EAAEE,YAAoCD,SAAtBH,EAAMI,aAA4B,GAAO,EACzDF,EAAEP,UAAYU,SAASf,EAAMK,UAAW,IACxCL,EAAMgB,WAAahB,EAAMM,MAAQN,EAAMM,MAAQI,EAAMJ,MAAQI,EAAMJ,MAAQ,QACtEM,EAAET,aAAgBS,EAAER,aACvBQ,EAAER,YAAa,EACfQ,EAAET,aAAc,GAElBH,EAAMiB,SAAU,EAEhBjB,EAAMkB,KAAOC,EAAQP,GAErBZ,EAAMoB,QAAUR,EAAET,YAAc,aAAc,EAC9CH,EAAMqB,OAAST,EAAER,WACjBJ,EAAMsB,OAAS,GAAIC,OAAM,IACzBvB,EAAMwB,OAAS,GAAID,OAAM,GACzB,IAAIL,GAAO,KACPO,EAAO,WACJC,MAAMd,EAAEP,aACXO,EAAEP,UAAYO,EAAEP,UAAY,KAE9Ba,EAAOC,EAAQP,GACfZ,EAAMkB,KAAOA,EACTN,EAAET,cACJH,EAAMoB,QAAUO,EAAST,EAAMhB,EAAeD,EAAWH,IAI7Da,GAAWd,EAAU4B,EAAM,KAE3BzB,EAAM4B,OAAO,YAAa,SAASC,GAEjC5B,EAAY4B,EACZjB,EAAEX,UAA0B,MAAbA,EAAqB6B,EAAc7B,IAAa,EAC3DW,EAAEE,aAAeF,EAAEX,aAAc,IACnCD,EAAMiB,QAAUc,EAAWnB,EAAEX,YAG/BwB,MAEFzB,EAAM4B,OAAO,gBAAiB,SAASC,EAAOG,GACzCH,GAASG,IACV9B,EAAgB2B,KAGpB7B,EAAM4B,OAAO,cAAe,SAASC,EAAOG,GACvCH,GAASG,IACVpB,EAAET,YAAc0B,EAChB7B,EAAMoB,QAAUR,EAAET,YAAc,aAAc,KAGlDH,EAAM4B,OAAO,aAAc,SAASC,EAAOG,GACtCH,GAASG,IACVpB,EAAER,WAAayB,EACf7B,EAAMqB,OAASQ,KAGnB7B,EAAM4B,OAAO,QAAS,SAASC,EAAOG,GACjCH,GAASG,IACVhC,EAAMgB,WAAaa,EAAQA,EAAQnB,EAAMJ,MAAQI,EAAMJ,MAAQ,WAKnEG,EAAQwB,GAAG,WAAY,WACrBpC,EAAUqC,OAAOvB,GACjBA,EAAW,SAOnB,QAASmB,GAAcK,GACrBA,EAASC,WAAWD,EACpB,IAAIE,GAAIF,EAAS,EAAIG,KAAKC,MAAMJ,GAAUG,KAAKE,KAAKL,GAClDM,EAAKN,EAAS,EAAK,EAErB,OAAOE,GAAII,EAWb,QAASV,GAAWI,GAElB,GAAIE,GAAIF,EAAS,EAAIG,KAAKC,MAAMJ,GAAUG,KAAKE,KAAKL,GAClDM,EAAIH,KAAKI,OAAQP,EAAS,EAAIA,EAAkB,GAATA,GAAe,EAAK,GAE7D,OAAO,OAAoB,IAAXA,EAAe,IAAOA,EAAS,EAAI,KAAO,KAAOQ,EAAKN,GAAK,IAAMO,EAAKH,GAAGI,UAAU,EAAG,IAIxG,QAASF,GAAKG,GACZ,MAAU,GAANA,GACMA,EAAM,IAAM,KAAO,KAAc,GAANA,GAErB,GAANA,EAAW,IAAM,IAAMA,EAKnC,QAASF,GAAKE,GACZ,MAAOA,IAAa,GAANA,EAAW,IAAM,IAGjC,QAAS3B,GAAQP,GACf,GAAImC,GAAQrB,MAAMd,EAAEP,WAAsC,GAAI2C,MAA5B,GAAIA,MAAKpC,EAAEP,UAC7C,IAAoB,OAAhBO,EAAEX,WAAsBW,EAAEX,aAAc,EAAO,CAKjD,GAAIgD,GAAMF,EAAIG,UAAuC,IAA1BH,EAAII,oBAG3BC,EAAY,GAAIJ,MAAKC,EAAO,KAAUrC,EAAEX,UAC5C,QACEoD,IAAKD,EAAUE,WACfC,KAAMH,EAAUI,aAChBC,KAAML,EAAUM,aAChBxC,KAAMkC,GAIR,OACEC,IAAKN,EAAIO,WACTC,KAAMR,EAAIS,aACVC,KAAMV,EAAIW,aACVxC,KAAM6B,GAKZ,QAASpB,GAASgC,EAAGC,EAAQC,EAAU/D,GACrC,MAAOA,GAAQ,QAAQ6D,EAAEzC,KAAM0C,EAAQC,GAtKzCC,QAAQC,OAAO,eACZC,UAAU,iBAAkB,YAAa,UACxC,SAASnE,EAAWC,GAClB,MAAOF,GAAMC,EAAWC","file":"angular-clock.min.js","sourcesContent":["(function() {\r\n  'use strict';\r\n\r\n  /**\r\n   * Usage pattern\r\n   * <ds-widget-clock data-gmt-offset=\"0\"></ds-widget-clock> \r\n   */\r\n  var days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n  var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\n\r\n  angular.module('ds.clock', [])\r\n    .directive('dsWidgetClock', ['$interval', '$filter',\r\n      function($interval, $filter) {\r\n        return clock($interval, $filter);\r\n      }\r\n    ]);\r\n\r\n  function clock($interval, $filter) {\r\n    return {\r\n      restrict: 'EA',\r\n      scope: {\r\n        gmtOffset: '=gmtOffset',\r\n        digitalFormat: '=digitalFormat',\r\n        showDigital: '=showDigital',\r\n        showAnalog: '=showAnalog',\r\n        startTime: '=startTime',\r\n        theme: '=theme'\r\n      },\r\n      template: '<div class=\"widget-clock\" ng-class=\"themeClass\" ng-if=\"date\"><div class=\"digital\" ng-if=\"digital\"><span class=\"time\"><span class=\"hours\">{{digital}}</span></span></div><div class=\"analog\" ng-if=\"analog\"><div class=\"square\"><svg viewBox=\"0 0 100 100\"><g transform=\"translate(50,50)\"><circle class=\"clock-face\" r=\"48\" /><line ng-repeat=\"minor in minors track by $index\" class=\"minor\" y1=\"42\" y2=\"45\" ng-attr-transform=\"rotate({{360 * $index / minors.length}})\" /><line ng-repeat=\"major in majors track by $index\" class=\"major\" y1=\"35\" y2=\"46\" ng-attr-transform=\"rotate({{360 * $index / majors.length}})\" /><line class=\"hour\" y1=\"2\" y2=\"-20\" ng-attr-transform=\"rotate({{30 * date.hrs + date.mins / 2}})\" /><line class=\"minute\" y1=\"4\" y2=\"-30\" ng-attr-transform=\"rotate({{6 * date.mins + date.secs / 10}})\" /><g ng-attr-transform=\"rotate({{6 * date.secs}})\"><line class=\"second\" y1=\"10\" y2=\"-38\" /><line class=\"second-counterweight\" y1=\"10\" y2=\"2\" /></g></g></svg></div></div><div ng-if=\"gmtInfo\" class=\"gmt-info\">{{gmtInfo}}</div></div>',\r\n      link: function(scope, element, attrs) {\r\n        var format, // date format\r\n          stopTime; // so that we can cancel the time updates\r\n        var o = {};\r\n        var gmtOffset = scope.gmtOffset;\r\n        var digitalFormat = scope.digitalFormat ? scope.digitalFormat : 'HH:mm:ss';\r\n        o.showDigital = scope.showDigital != null ? scope.showDigital : attrs.showDigital !== undefined ? true : false;\r\n        o.showAnalog = scope.showAnalog != null ? scope.showAnalog : attrs.showAnalog !== undefined ? true : false;\r\n        o.showGmtInfo = attrs.showGmtInfo !== undefined ? true : false;\r\n        o.startTime = parseInt(scope.startTime, 10); // ms\r\n        scope.themeClass = scope.theme ? scope.theme : attrs.theme ? attrs.theme : 'light';\r\n        if (!o.showDigital && !o.showAnalog) {\r\n          o.showAnalog = true;\r\n          o.showDigital = true;\r\n        }\r\n        scope.gmtInfo = false;\r\n\r\n        scope.date = getDate(o);\r\n\r\n        scope.digital = o.showDigital ? 'Loading..' : false;\r\n        scope.analog = o.showAnalog;\r\n        scope.majors = new Array(12);\r\n        scope.minors = new Array(60);\r\n        var date = null;\r\n        var tick = function() {\r\n          if (!isNaN(o.startTime)) {\r\n            o.startTime = o.startTime + 1000;\r\n          }\r\n          date = getDate(o);\r\n          scope.date = date;\r\n          if (o.showDigital) {\r\n            scope.digital = timeText(date, digitalFormat, gmtOffset, $filter);\r\n          }\r\n        };\r\n\r\n        stopTime = $interval(tick, 1000);\r\n        // watch the expression, and update the UI on change.\r\n        scope.$watch('gmtOffset', function(value, old) {\r\n          \r\n          gmtOffset = value;\r\n          o.gmtOffset = (gmtOffset != null) ? getGMTbase100(gmtOffset) : false;\r\n          if (o.showGmtInfo && o.gmtOffset !== false) {\r\n            scope.gmtInfo = getGMTText(o.gmtOffset);\r\n          }\r\n          \r\n          tick();\r\n        });\r\n        scope.$watch('digitalFormat', function(value, old) {\r\n          if(value != old){\r\n            digitalFormat = value;\r\n          }\r\n        });\r\n        scope.$watch('showDigital', function(value, old) {\r\n          if(value != old){\r\n            o.showDigital = value;\r\n            scope.digital = o.showDigital ? 'Loading..' : false;;\r\n          }\r\n        });\r\n        scope.$watch('showAnalog', function(value, old) {\r\n          if(value != old){\r\n            o.showAnalog = value;\r\n            scope.analog = value;\r\n          }\r\n        });\r\n        scope.$watch('theme', function(value, old) {\r\n          if(value != old){\r\n            scope.themeClass = value ? value : attrs.theme ? attrs.theme : 'light';\r\n          }\r\n        });\r\n        // listen on DOM destroy (removal) event, and cancel the next UI update\r\n        // to prevent updating time after the DOM element was removed.\r\n        element.on('$destroy', function() {\r\n          $interval.cancel(stopTime);\r\n          stopTime = null;\r\n        });\r\n\r\n      }\r\n    };\r\n  }\r\n\r\n  function getGMTbase100(offset) {\r\n    offset = parseFloat(offset);\r\n    var f = offset > 0 ? Math.floor(offset) : Math.ceil(offset),\r\n      s = (offset % 1) / 0.6;\r\n\r\n    return f + s;\r\n\r\n  }\r\n\r\n  function getGMTbase60(offset) {\r\n    var f = offset > 0 ? Math.floor(offset) : Math.ceil(offset),\r\n      s = ((offset > 0 ? offset : offset * -1) % 1) * 60;\r\n    return f + s;\r\n\r\n  }\r\n\r\n  function getGMTText(offset) {\r\n\r\n    var f = offset > 0 ? Math.floor(offset) : Math.ceil(offset),\r\n      s = Math.round(((offset > 0 ? offset : offset * -1) % 1) * 60);\r\n\r\n    return 'GMT' + (offset === 0 ? '' : ((offset > 0 ? ' +' : ' ') + lpad(f) + '.' + rpad(s).substring(0, 2)));\r\n\r\n  }\r\n\r\n  function lpad(num) {\r\n    if (num < 0) {\r\n      return (num > -10 ? '-0' : '-') + (num * -1);\r\n    } else {\r\n      return (num < 10 ? '0' : '') + num;\r\n    }\r\n\r\n  }\r\n\r\n  function rpad(num) {\r\n    return num + (num < 10 ? '0' : '');\r\n  }\r\n  // Checkfor offset and get correct time\r\n  function getDate(o) {\r\n    var now = (!isNaN(o.startTime)) ? new Date(o.startTime) : new Date();\r\n    if (o.gmtOffset !== null && o.gmtOffset !== false) {\r\n      /*Use GMT + gmtOffset\r\n      convert to msec\r\n      add local time zone offset\r\n      get UTC time in msec*/\r\n      var utc = now.getTime() + (now.getTimezoneOffset() * 60000);\r\n      // create new Date object for different city\r\n      // using supplied offset\r\n      var offsetNow = new Date(utc + (3600000 * o.gmtOffset));\r\n      return {\r\n        hrs: offsetNow.getHours(),\r\n        mins: offsetNow.getMinutes(),\r\n        secs: offsetNow.getSeconds(),\r\n        date: offsetNow\r\n      };\r\n    } else {\r\n      // Use local time\r\n      return {\r\n        hrs: now.getHours(),\r\n        mins: now.getMinutes(),\r\n        secs: now.getSeconds(),\r\n        date: now\r\n      };\r\n    }\r\n  }\r\n\r\n  function timeText(d, format, timezone, $filter) {\r\n    return $filter('date')(d.date, format, timezone);\r\n  }\r\n\r\n})();\r\n"],"sourceRoot":"/source/"}